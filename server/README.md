# Сервер

## Требования

  * Получает и рассылает сообщения от клиентов. Рассылка должна исключать отправителя.
  * При подключении клиента проверяет наличие пользователя, правильность пароля и
    единственность подключения, в случае отказа возвращает два типа ошибки: auth_error
    (не найден пользовать или не подходит пароль) и always_connection (для данного пользователя
    уже есть активное соединение).
  * Через консоль позволяет добавлять пользователей с паролем (без какой либо крипты, защищать ничего не нужно).
  * Падение обработки входящего запроса не должно аффектить на работоспособность сервера
    и рвать соединения других клиентов.

## Зависимости

Для работы данного приложения необходимо наличие установленных:

  * erlang 25.0
  * elixir 1.14.0-otp-25
  * docker, docker-compose

Руководство по установке зависимостей находится в корне репозитория.

## Запуск БД

В качестве БД используется postgres:16.2-alpine3.19, необходим свободный порт 5432.
Порт можно переназначить, для этого необходимо внести изменения в `docker-compose.yml`
и конфигурационный файл `config/config.exs`.
Для запуска БД из корня проекта Server выполните следующую команду:
`docker-compose up -d`

## Получение зависимостей, инициализация и миграция ДБ

Из корня проекта Server выполните команду `mix setup`

## Запуск тестов

Для запуска тестов необходима запущенная и инициализированная БД.
Из корня проекта Server выполните команду `mix test`

## Запуск сервера

Из корня проекта Server выполните команду `iex -S mix`

## Описание функционала клиента

Основная документация по клиенту доступна в модуле `Server`.

## Некоторые примеры использования

### Создание пользователя

`Server.create_user("user", "password")`

### Просмотр всех пользователей в БД

`Server.users()`

### Просмотр пользователей подключённых к серверу в данный момент

`Server.users_online()`